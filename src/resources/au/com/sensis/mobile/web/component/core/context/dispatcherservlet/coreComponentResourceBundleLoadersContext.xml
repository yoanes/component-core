<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:util="http://www.springframework.org/schema/util"
        xmlns:context="http://www.springframework.org/schema/context"
        xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
                http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd
                http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd">
                
    <!-- ================================================================================================ -->
    <!-- Resource Bundle Loaders. -->
    
    <bean name="core.comp.abstractResourceBundleLoader" 
        class="au.com.sensis.mobile.web.component.core.bundle.AbstractResourceBundleLoader" abstract="true"
        init-method="validateState">
        
        <property name="bundleNameRegex" value="(.*?)/js/(.*)" />
        
        <property name="bundleNameReplacement" value="/js/bundles/$1/$2" />
        <property name="bundleExploderNameReplacement" value="/js/bundleExploders/$1/$2" />
        
        <property name="explodedBundleMemberNameRegex" value="(.*?)/jsmember/(.*)" />
        <property name="explodedBundleMemberNameReplacement" value="/js/explodedBundles/$2" />
    </bean>
    
    <bean name="core.comp.resourceBundleLoader" class="au.com.sensis.mobile.web.component.core.bundle.ChainedResourceBundleLoader">
        <constructor-arg index="0">
            <list>

                <!-- For a production app, this resource loader will find everything we need. -->
                <bean class="au.com.sensis.mobile.web.component.core.bundle.ClasspathResourceBundleLoader"
                    parent="core.comp.abstractResourceBundleLoader"
                    init-method="validateState" />
                 
                 <!-- 
                   - For a showcase app that has been deployed with an exploded component JAR, this resource
                   - will find the exploded resources (the first loader above will fail). 
                   -->
                <bean class="au.com.sensis.mobile.web.component.core.bundle.ServletContextResourceBundleLoader"
                    parent="core.comp.abstractResourceBundleLoader"
                    init-method="validateState">
                    <property name="servletContextPathPrefix" value="/WEB-INF/"/>    
                    <property name="servletContext">
                        <bean class="org.springframework.web.context.support.ServletContextFactoryBean"/>
                    </property>    
                </bean>
            </list>
        </constructor-arg>
    </bean>
     
    
</beans>
